import 'package:file_picker/file_picker.dart';
import 'package:path/path.dart';
import 'package:excel/excel.dart';
import 'package:flutter/material.dart';
import 'package:otif_input/components/background';
import 'package:date_time_picker/date_time_picker.dart';
import 'package:intl/intl.dart';
import 'package:otif_input/function/insertExcelRow';
class xlsx{
  Future<void> insertExcelRow(List<String> dataList) async {
    FilePickerResult? pickedFile = await FilePicker.platform.pickFiles(
      type: FileType.custom,
      allowedExtensions: ['xlsx'],
      allowMultiple: false,
    );

    /// file might be picked
    if (pickedFile != null) {
      var bytes = pickedFile.files.single.bytes;
      var excel = Excel.decodeBytes(bytes!);
      Sheet sheetObject = excel['Sheet1'];
      // for (var table in excel.tables.keys) {
      //   // print(table); //sheet Name
      //   // print(excel.tables[table]?.maxCols);
      //   // print(excel.tables[table]?.maxRows);
      //   for (var row in excel.tables[table]!.insertRow(rowIndex: 1)) {
      //     print('$row');
      //   }
      // }
      // excel.tables["Sheet1"]!.appendRow(row)
      // sheetObject.appendRow(['Flutter', 'till', 'Eternity']);
      // var defaultSheet = excel.getDefaultSheet();
      //  print('Default Sheet:' + defaultSheet.toString());

      sheetObject.insertRowIterables(dataList, 8);
      excel.save(fileName: 'My_Excel_File_Name.xlsx');
      //       var fileBytes = excel.save();
      // var directory = await getApplicationDocumentsDirectory();

      // File(join('$directory/output_file_name.xlsx'))
      //   ..createSync(recursive: true)
      //   ..writeAsBytesSync(fileBytes);
    }
  }
}